## Модульные тесты

1. Поле "card_number"

1.1. Если поле card_number содержит пробельные символы, удаляем их.

1.2. Если длина поля card_number (после удаления пробелов) не равна 16 символам, метод возвращает 400 с сообщением об ошибке.

1.3. Если поле card_number содержит не только целочисленные символы, метод возвращает 400 с сообщением об ошибке.

---

## Интеграционные тесты

1. Проверяем связку "фронт-бэк"

1.1. Отправляем запрос с корректными данными на бэк, ожидаем HTTP-код 200 и успешное выполнение операции.

1.2. Отправляем запрос с некорректными данными на бэк, ожидаем HTTP-код 400 и соответствующее сообщение об ошибке. Убеждаемся, что фронт выделяет соответствующее поле красной рамкой.

1.3. Проверяем, что в ответе от бэка есть информация о списании средств.

1.4. Проверяем, что успешная оплата приводит к редиректу на страницу с сообщением об успешной оплате или доступом к фильму.

...

2. Проверяем связку "бэк-репозиторий"

2.1. Отправляем успешный запрос на списание денег в бэк, и проверяем, что метод репозитория setOrderIsPaid вызывается один раз и возвращает true.

2.2. Отправляем запрос на списание денег в бэк, вызываем метод репозитория setOrderIsPaid с несоответствующим номером заказа, и проверяем, что метод setOrderIsPaid бросает исключение.

---

## Системные тесты

1. Если CVV неверен, то после получения ответа от бэка на фронте выводится сообщение об ошибке "Не удалось списать данные с карты, проверьте правильность введенных данных".

2. Если списание денег не удалось (HTTP-код 403 от сервиса A), то после получения ответа от бэка на фронте выводится сообщение об ошибке, которую прислал сервис А.

3. При успешной оплате (HTTP-код 200 от сервиса A) убеждаемся, что информация об успешной оплате записана в базу данных и на фронте произошёл редирект на страницу с сообщением об успешной оплате или на страницу с доступом к фильму.

3.1. Проверяем, что метод репозитория setOrderIsPaid вызывается после успешной оплаты и возвращает true.

3.2. Проверяем, что информация об успешной оплате в базе данных содержит правильные данные заказа.
