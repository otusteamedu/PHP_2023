# PHP_2023

https://otus.ru/lessons/razrabotchik-php/?utm_source=github&utm_medium=free&utm_campaign=otus

# Задание

## Цель
Научиться создавать универсальный интерфейс для различных потребителей (frontend фреймворки, мобильные приложения, сторонние приложения)

## Описание/Пошаговая инструкция выполнения домашнего задания:
* Необходимо реализовать Rest API с использованием очередей.
* Ваши клиенты будут отправлять запросы на обработку, а вы будете складывать их в очередь и возвращать номер запроса.
* В фоновом режиме вы будете обрабатывать запросы, а ваши клиенты периодически, используя номер запроса, будут проверять статус его обработки.

## Разрешается

* Использование Composer-зависимостей
* Использование микрофреймворков (Lumen, Silex и т.п.)

# Установка

## Изолированное окружение

Для развёртывания изолированного окружения пропишите команду
```bash
vagrant up
```

После установки, зайдите в ОС
```bash
vagrant ssh
```

## Подготовка и запуск среды
```bash
cd /vagrant/application && cp .env.example .env
```

Далее, заполните все пустые строки нужными данными в файле `.env`

После чего выполните команду

```bash
sudo docker compose up -d
```

Добавьте сайт `mysite.local` в файл `hosts`
```bash
127.0.0.1 mysite.local
```

Готово!

# Использование

Для того, чтобы посмотреть список доступных урлов, сделайте запрос 
```text
http://mysite.local/api-docs
```

Для того, чтобы отправить запрос на обработку, сделайте POST запрос (детали можно увидеть в документации по запросу выше)
```text
http://mysite.local/requests
```

Для получение статуса запроса сделайте GET запрос, где `{id}` - это номер запроса, полученного ответом от сервера по запросу выше
```text
http://mysite.local/requests/{id}
```

Для запуска consumer-а, выполните команду
```bash
sudo docker compose exec fpm bash
php console.php receive.php
```
