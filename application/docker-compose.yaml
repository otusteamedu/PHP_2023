services:
  web:
    build: config/nginx
    container_name: myapp-server${DOCKER_CONTAINER_SUFFIX}
    ports: 
      - "80:80"

  fpm:
    build: config/php
    container_name: myapp-php${DOCKER_CONTAINER_SUFFIX}
    ports:
      - ":9000"
    volumes:
      - ./:/data/www
      - ./config/php/start.sh:/data/config/start.sh
    environment:
      MYAPP_RABBITMQ_USER: ${RABBITMQ_DEFAULT_USER}
      MYAPP_RABBITMQ_PASS: ${RABBITMQ_DEFAULT_PASS}

  queue:
    image: rabbitmq
    container_name: myapp-queue${DOCKER_CONTAINER_SUFFIX}
    environment:
        RABBITMQ_DEFAULT_USER: ${RABBITMQ_DEFAULT_USER}
        RABBITMQ_DEFAULT_PASS: ${RABBITMQ_DEFAULT_PASS}