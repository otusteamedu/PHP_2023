# Домашняя работа №16

## Задача

Разработайте несложный REST API (только backend!) для новостного сайта.

#### Сущность Новости:

- название
- дата создания
- автор
- категория (например, "Политика" или "Спорт")
- текст (HTML)

#### Методы API:

- создать новость
- загрузить список новостей
- загрузить новость
- подписаться на новости по конкретной категории

#### Паттерны проектирования:

- используйте Строитель, чтобы пошагово построить объект Новости
- используйте Декоратор, чтобы добавить дополнительную информацию в HTML-код новости: "Время чтения: N минут" или "Поделиться: [ссылки на соцсети]"
- используйте Цепочку обязанностей, чтобы реализовать Middleware для доступа к новостям (черный список IP + ограничение нагрузки — не больше 10 запросов в минуту суммарно со всех IP)
- используйте Наблюдатель, чтобы можно было подписаться на новости по конкретной категории и получать E-mail в момент появления новых новостей

#### Реализация:

- можно взять готовый фреймворк (Symfony, Laravel, Yii...)
- но при этом нельзя брать готовые библиотеки для реализации паттернов (их нужно написать "руками")
- REST API должен работать с JSON; фронт-енд писать не нужно

## Решение

Черный список IP адресов указывается в .env переменной `BLACK_LIST_IP_ADDRESSES`.

Допустимое кол-во запросов в минуту - в .env переменной `RATE_LIMIT`.

Для создания категорий и пользователей добавлены консольные команды:

```shell
bin/console app:category:create
bin/console app:user:create
```

#### Публикация новости:

```http request
POST /api/v1/news

{
    "title": "News",
    "content": "Content of news",
    "authorId": 1,
    "categoryId": 1
}
```

#### Чтение новости:

```http request
GET /api/v1/news/{news_id}
```

#### Постраничная навигация по новостям

```http request
GET /api/v1/news?page=1&perPage=20
```

#### Подписка на новости

```http request
POST /api/v1/subscriptions

{
    "userId": 1,
    "categoryId": 1
}
```

## Запуск

```shell
docker-compose up -d
docker exec -it imitronov_hw16_app bin/console d:m:m
```
