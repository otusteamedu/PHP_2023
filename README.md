# PHP_2023

https://otus.ru/lessons/razrabotchik-php/?utm_source=github&utm_medium=free&utm_campaign=otus

# Модульные тесты

1. `бэк`:
    1. Проверка входных данных, при тестировании поля, другие поля заполняем корректно:
        1. Поле `card_holder` не соответствует шаблону `^\[A-Za-z\-]+\s[A-Za-z\-]+$` и ответ отличный от `400` - тест провален,  иначе - выполнен.
        1. поле `card_holder`  соответствует шаблону `^\[A-Za-z\-]+\s[A-Za-z\-]+$` и ответ отличный от `200` - тест провален,  иначе - выполнен.
        1. Если поле `card_number` не соответствует шаблону `^\d{16}$`  ответ отличный от `400` - тест провален,  иначе - выполнен.
        1. Если поле `card_number` соответствует шаблону `^\d{16}$` и ответ отличный от `200` - тест провален,  иначе - выполнен.
      
        1. Проверка поля `card_expiration`:
            1. Не соответствует шаблону `^\d{2}/\d{2}$` и ответ отличный от `400` - тест провален,  иначе - выполнен.
            1. Соответствует шаблону `^\d{2}/\d{2}$` и ответ отличный от `200` - тест провален,  иначе - выполнен.
            1. Если `MM-ГГ` в поле `card_expiration` меньше текущего месяца и года и ответ отличный от `400` - тест провален,  иначе - выполнен.
            1. Если `MM-ГГ` в поле `card_expiration` больше или равно текущему месяцу и году и ответ отличный от `200` - тест провален,  иначе - выполнен.
        1. Если поле `cvv` не соответствует шаблону `^\d{3}$` и ответ отличный от `400` - тест провален,  иначе - выполнен.
        1. Если поле `cvv`  соответствует шаблону `^\d{3}$` - тест провален,  иначе - выполнен.
        1. Если поле `order_number` не соответствует шаблону `^\w{1,16}$` и ответ отличный от `400` - тест провален,  иначе - выполнен.
        1. Если поле `order_number` соответствует шаблону `^\w{1,16}$` и ответ отличный от `200` - тест провален,  иначе - выполнен.
        1. Если поле `sum` не соответствует шаблону `^\d+(,\d{1,2})?$` и ответ отличный от `400` - тест провален,  иначе - выполнен.
        1. Если поле `sum` соответствует шаблону `^\d+(,\d{1,2})?$` и ответ отличный от `200` - тест провален,  иначе - выполнен.
       
    1. Проверка ответов от `сервиса А`, проводить тесты лучше на тестовом стенде сервиса А, чтобы избежать траты денежных средств:
        1. Посылаем сервису заведомо верные данные тестовой карты, если ответ от сервиса с кодом отличным от `200` - тест провален, если ответ   иначе - выполнен.
        1. Посылаем сервису заведомо неверные данные, если ответ от сервиса с кодом отличным от `403` - тест провален,  иначе - выполнен.
     
    1. Проверка репозитория - подменяем его мок объектом:
        1. передаем в функцию setOrderIsPaid верные данные в пустой репозиторий, если возвращается `false` тест пройден, иначе провален
        1. передаем в функцию setOrderIsPaid верные данные в репозиторий, где уже есть информация о заказе, он оплачен, если возвращается `false` тест пройден, иначе провален
        1. передаем в функцию setOrderIsPaid верные данные в репозиторий, где уже есть информация о заказе, он не оплачен, если возвращается `true` тест пройден, иначе провален
        1. передаем данные которые вызывают исключения, если исключений нет - тест провален, иначе выполнен

    
## Интеграционные тесты
1. `бэк - фронт`:
    1. В ответе имеется поле `card_number` и ответ `400`  поле выделено красным и показан тект ошибки - тест пройден, иначе провален
    1. В ответе имеется поле `card_holder` и ответ `400` поле выделено красным и показан тект ошибки - тест пройден, иначе провален
    1. В ответе имеется поле `card_expiration` и ответ `400` поле выделено красным и показан тект ошибки - тест пройден, иначе провален
    1. В ответе имеется поле `cvv`  и ответ `400` поле выделено красным и показан тект ошибки - тест пройден, иначе провален
    1. В ответе имеется поле `order_number` и ответ `400` поле выделено красным и показан тект ошибки - тест пройден, иначе провален
    1. Получен ответ с кодом `400` ответ без указания поля - выведено сообщение об ошибке по умолчанию - тест пройден, иначе провален
    1. Получен ответ с кодом `200` если отображено сообщение об успехе - тест пройден, иначе провален
   
1. `сервис А - бэк ` , вместо сервиса А, используем МОК-объект который генерирует ответы с кодами  `200` и `403`:
    1. сервиса А отдает `200` ответ, если бэк ответчает кодом отличным от `200` - тест провален, иначе - выполнен.
    1. сервиса А отдает `403` ответ, если бэк ответчает кодом отличным от `400` - тест провален, иначе - выполнен.
1. `бэк- сервис А(тестовый стенд)` :
    1. передаем заведомо верные данные  `бэку`, если `сервис А`  ответчает кодом отличным от `200` - тест провален, иначе - выполнен.
    1. передаем заведомо неверные данные  `бэку`, если `сервис А`  ответчает кодом `200` - тест провален, иначе - выполнен.
1. `репозиторий - бэк` `сервис А`  - МОК-объект, всегда отвечает `200`:
    1. `setOrderIsPaid` отдает `false`, если `бэк` ответчает кодом отличным от `400` - тест провален,  иначе - выполнен.
    1. `setOrderIsPaid` отдает `true`, если `бэк` ответчает кодом отличным от `200` - тест провален,  иначе - выполнен.
   

## Системные тесты
1. Введены корректные данные карты и на `фронте` и отображается сообщение об успешной оплате - тест пройден, иначе провален.
1. Введены некорректные данные карты и на `фронте` и отображается сообщение об ошибке - тест пройден, иначе провален.
1. Используем данные карты с нулевым балансом, если на `фронте`отображается сообщение об ошибке - тест пройден, иначе провален.
1. Оплачиваем с двух вкладок барузера 1 заказ, если на `фронте`  влкадки оплаченой второй отображается сообщение об ошибке - тест пройден, иначе провален.

