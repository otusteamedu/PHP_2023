# Проект до рефакторинга

Код проекта можно посмотреть по [ссылке](https://github.com/otusteamedu/PHP_2023/tree/ACherepanov1/hw12) 

## Проблемы

### 1. Нет архитектуры в структуре проекта

Проект не имеет слоев. Таким образом при добавлении функционала, все это будет хаотично разбросано по папкам.

### 2. Нарушение принципа единой ответственности

Класс `app/src/Factory/RedisIndexFactory.php` занимается несколькими вещами: создает клиента и передает его в 
качестве аргумента для создания индекса.

### 3. Нарушение принципа инверсии зависимостей

В классе `app/src/Factory/RedisIndexFactory.php` создается объект с жесткой привязкой к классу - RedisClientAdapter. 
Если нужно будет поменять клиента, нужно будет изменять его во всем коде.

# Проект после рефакторинга

В текущей ветке лежит код после рефакторинга

## Решение проблем

1. Разделил код проекта на слои Infrastructure, Application, Domain

2. Добавил статический анализатор зависимостей - `deptrack`. Указал в дептраке что `Domain` не зависит ни от чего.
   `Application` зависит только от `Domain`. `Infrastructure` зависит от слоя `Application` и от `Domain`.
   Теперь направление зависимостей контролируется явно.

3. Заменил явные зависимости на интерфейсы.

4. Создал отдельный класс репозиторий для добавления событий в Редис и получения событий из Редиса.