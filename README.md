# PHP_2023

https://otus.ru/lessons/razrabotchik-php/?utm_source=github&utm_medium=free&utm_campaign=otus

# Задание

## Цель:
Научиться создавать приложение с использованием ElasticSearch.
Закрепить навыки работы с БД на уровне логики.


## Описание/Пошаговая инструкция выполнения домашнего задания:
реализуем поиск по книжному интернет-магазину с помощью Elasticsearch

у каждого товара есть название, категория, цена и кол-во остатков на складе
поиск должен корректно работать с опечатками и русской морфологией
пример: пользователь ищет все исторические романы дешевле 2000 рублей (и в наличии) по поисковому запросу "рыцОри"

в результате должны вернуться товары, ранжированные по релевантности

домашку нужно сдать как консольное PHP-приложение, которое принимает один или несколько параметров командной строки и выводит результат в виде текстовой таблички, после чего завершает работу
JSON с товарами будет приложен к занятию в ЛК

способ создания индекса и его первоначального заполнения — на ваш выбор

## Критерии оценки:
* Работа c ES при помощи готовых библиотек
* Выделен слой кода, отвечающий за работу с хранилищем.

# Установка

## Изолированное окружение

Для развёртывания изолированного окружения пропишите команду
```bash
vagrant up
```

После установки, зайдите в ОС
```bash
vagrant ssh
```

## Подготовка и запуск среды
```bash
cd /vagrant/application && cp .env.example .env
```

Далее, заполните все пустые строки нужными данными в файле `.env`

После чего выполните команду

```bash
sudo docker compose up -d
```

Перейдите в контейнер приложения
```bash
sudo docker compose exec -it fpm bash
```

В контейнере нужно настроить окружение:
```bash
cd /data/www/ && composer install
```

Настраиваем работу эластика:

```bash
cd console && php console.php delete-index && php console.php create-index && php console.php bulk
```

Теперь можно пользоваться приложением!

# Использование

Для просмотра всех команд приложения, введите в консоли
```bash
php console.php
```

Там Вы найдёте и структуру команды поиска, и другие доступные команды 

Для поиска, введите следующую команду:
```bash
php console.php search 2000 'рыцари'
```

Для запроса по неточному поиску

```bash
php console.php search 2000 'под мухай'
```
