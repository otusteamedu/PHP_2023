Merge Join  (cost=48.67..50.08 rows=9 width=68)
  Merge Cond: (movie.id = s.movie_id)
  ->  Index Scan using movie_pkey on movie  (cost=0.15..18.65 rows=300 width=38)
  ->  Sort  (cost=48.52..48.54 rows=9 width=30)
        Sort Key: s.movie_id
        ->  Seq Scan on showtime s  (cost=0.00..48.38 rows=9 width=30)
              Filter: (date(start_time) = CURRENT_DATE)


Gather  (cost=1000.00..103166.12 rows=19654 width=30)
  Workers Planned: 2
  ->  Parallel Seq Scan on ticket  (cost=0.00..100200.73 rows=8189 width=30)
        Filter: ((sale_date <= CURRENT_DATE) AND (sale_date >= (CURRENT_DATE - '6 days'::interval)))
JIT:
  Functions: 2
"  Options: Inlining false, Optimization false, Expressions true, Deforming true"


GroupAggregate  (cost=50.23..50.41 rows=9 width=41)
  Group Key: m.name
  ->  Sort  (cost=50.23..50.25 rows=9 width=17)
        Sort Key: m.name
        ->  Merge Join  (cost=48.67..50.08 rows=9 width=17)
              Merge Cond: (m.id = s.movie_id)
              ->  Index Scan using movie_pkey on movie m  (cost=0.15..18.65 rows=300 width=13)
              ->  Sort  (cost=48.52..48.54 rows=9 width=12)
                    Sort Key: s.movie_id
                    ->  Seq Scan on showtime s  (cost=0.00..48.38 rows=9 width=12)
                          Filter: (date(start_time) = CURRENT_DATE)


Limit  (cost=76837.62..76837.63 rows=3 width=41)
  ->  Sort  (cost=76837.62..76838.37 rows=300 width=41)
        Sort Key: (sum(t.price)) DESC
        ->  Finalize GroupAggregate  (cost=76755.49..76833.75 rows=300 width=41)
              Group Key: m.name
              ->  Gather Merge  (cost=76755.49..76825.50 rows=600 width=41)
                    Workers Planned: 2
                    ->  Sort  (cost=75755.47..75756.22 rows=300 width=41)
                          Sort Key: m.name
                          ->  Partial HashAggregate  (cost=75739.37..75743.12 rows=300 width=41)
                                Group Key: m.name
                                ->  Hash Join  (cost=76.74..75678.66 rows=12142 width=15)
                                      Hash Cond: (s.movie_id = m.id)
                                      ->  Hash Join  (cost=66.99..75636.60 rows=12142 width=10)
                                            Hash Cond: (t.showtime_id = s.id)
                                            ->  Parallel Seq Scan on ticket t  (cost=0.00..69003.10 rows=2495810 width=10)
                                            ->  Hash  (cost=66.88..66.88 rows=9 width=8)
                                                  ->  Seq Scan on showtime s  (cost=0.00..66.88 rows=9 width=8)
                                                        Filter: ((date(start_time) <= CURRENT_DATE) AND (date(start_time) >= (CURRENT_DATE - '6 days'::interval)))
                                      ->  Hash  (cost=6.00..6.00 rows=300 width=13)
                                            ->  Seq Scan on movie m  (cost=0.00..6.00 rows=300 width=13)


HashAggregate  (cost=83187.49..83187.87 rows=30 width=38)
  Group Key: hr.id
  ->  Hash Right Join  (cost=1002.50..83076.68 rows=22163 width=8)
"        Hash Cond: (t.""row"" = hr.id)"
        ->  Gather  (cost=1000.00..82891.43 rows=66488 width=4)
              Workers Planned: 2
              ->  Parallel Seq Scan on ticket t  (cost=0.00..75242.62 rows=27703 width=4)
                    Filter: (showtime_id = 2)
        ->  Hash  (cost=2.12..2.12 rows=30 width=6)
              ->  Seq Scan on hall_row hr  (cost=0.00..2.12 rows=30 width=6)
                    Filter: (hall_id = 3)


Aggregate  (cost=83893.04..83893.05 rows=1 width=64)
  ->  Nested Loop  (cost=1000.28..83560.60 rows=66488 width=6)
        ->  Index Only Scan using showtime_pkey on showtime s  (cost=0.28..4.29 rows=1 width=4)
              Index Cond: (id = 2)
        ->  Gather  (cost=1000.00..82891.43 rows=66488 width=10)
              Workers Planned: 2
              ->  Parallel Seq Scan on ticket t  (cost=0.00..75242.62 rows=27703 width=10)
                    Filter: (showtime_id = 2)


Aggregate  (cost=83569.81..83569.82 rows=1 width=64)
  ->  Nested Loop  (cost=1000.28..83251.35 rows=63693 width=6)
        ->  Index Only Scan using showtime_pkey on showtime s  (cost=0.28..2.50 rows=1 width=4)
              Index Cond: (id = 2)
        ->  Gather  (cost=1000.00..82611.93 rows=63693 width=10)
              Workers Planned: 2
              ->  Parallel Seq Scan on ticket t  (cost=0.00..75242.62 rows=26539 width=10)
                    Filter: (showtime_id = 2)
