## Модульные тесты

1. Поле "card_number"

1.1. Если поле card_number содержит пробельные символы, удаляем их.

1.2. Если длина поля card_number (после удаления пробелов) не равна 16 символам, метод возвращает 400 с сообщением об ошибке.

1.3. Если поле card_number содержит не только целочисленные символы, метод возвращает 400 с сообщением об ошибке.

2. Поле "card_holder"

2.1. Если поле card_holder содержит пробельные символы по краям строки, обрезаем их.

2.2. Если одна из проверок не проходит, метод возвращает 400 с сообщением об ошибке.
- Поле card_holder содержит более одного пробела
- Поле card_holder пустая строка
- Поле card_holder содержит меньше двух слов
- Поле card_holder содержит не только символы латинского алфавита и одного разделяющего пробела
- Поле card_holder не является строкой
- Поле card_holder превышено ограничение по количеству символов

2.3. Если поле card_holder является строкой в нижнем регистре, то переводим её в верхний.

3. Поле "card_expiration"

3.1. Если поле card_expiration имеет некорректный формат (мм/гг), метод возвращает 400 с сообщением об ошибке.

3.2. Если введенная в поле card_expiration дата, ранее текущей даты (мм/гг).

4. Поле "cvv"

4.1. Если поле cvv содержит пробельные символы, удаляем их.

4.2. Если длина поля cvv не равна трём символам (после удаления пробелов), метод возвращает 400 с сообщением об ошибке.

4.3. Если cvv содержит не целочисленные символы (0-9), метод возвращает 400 с сообщением об ошибке.

5. Поле "order_number"

5.1. Если поле order_number состоит из более чем 16 символов, метод возвращает 400 с сообщением об ошибке.

5.2. Если поле order_number пустая строка, метод возвращает 400 с сообщением об ошибке.

6. Поле "sum"

6.1. Если поле sum начинается с символа ",", метод возвращает 400 с сообщением об ошибке.

6.2. Если поле sum содержит не целочисленные символы (0-9) и символы ",", метод возвращает 400 с сообщением об ошибке.

6.3. Если поле sum содержит более одного символа ",", метод возвращает 400 с сообщением об ошибке.

7. Доступность и работоспособность сервиса

7.1. Проверить подключение клиента к серверу. Проверить, что сервер работает на стандартных портах, 80 (HTTP) и 444 (HTTPS). В случае успешного запроса метод возвращает ответ 200.

7.2. Предусмотреть возможность запуска сервиса с минимальной стоимость - 1 копейка, которую сможет успешно обработать сервис. Таким образом при многочисленных успешных оплатах будут минимальные денежные затраты на тестирование.

---

## Интеграционные тесты

1. Проверяем связку "фронт-бэк"

1.1. Отправляем запрос с корректными данными на бэк, ожидаем HTTP-код 200 и успешное выполнение операции.

1.2. Отправляем запрос с некорректными данными на бэк, ожидаем HTTP-код 400 и соответствующее сообщение об ошибке. Убеждаемся, что фронт выделяет соответствующее поле красной рамкой.

1.3. Проверяем, что в ответе от бэка есть информация о списании средств.

1.4. Проверяем, что успешная оплата приводит к редиректу на страницу с сообщением об успешной оплате или доступом к фильму.

...

2. Проверяем связку "бэк-репозиторий"

2.1. Отправляем успешный запрос на списание денег в бэк, и проверяем, что метод репозитория setOrderIsPaid вызывается один раз и возвращает true.

2.2. Отправляем запрос на списание денег в бэк, вызываем метод репозитория setOrderIsPaid с несоответствующим номером заказа, и проверяем, что метод setOrderIsPaid бросает исключение.

---

## Системные тесты

1. Если CVV неверен, то после получения ответа от бэка на фронте выводится сообщение об ошибке "Не удалось списать данные с карты, проверьте правильность введенных данных".

2. Если списание денег не удалось (HTTP-код 403 от сервиса A), то после получения ответа от бэка на фронте выводится сообщение об ошибке, которую прислал сервис А.

3. При успешной оплате (HTTP-код 200 от сервиса A) убеждаемся, что информация об успешной оплате записана в базу данных и на фронте произошёл редирект на страницу с сообщением об успешной оплате или на страницу с доступом к фильму.

3.1. Проверяем, что метод репозитория setOrderIsPaid вызывается после успешной оплаты и возвращает true.

3.2. Проверяем, что информация об успешной оплате в базе данных содержит правильные данные заказа.
